{{ config(
    indexes = [{'columns':['_airbyte_emitted_at'],'type':'btree'}],
    unique_key = '_airbyte_ab_id',
    schema = "_airbyte_pxhgpeza",
    tags = [ "top-level-intermediate" ]
) }}
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: {{ source('pxhgpeza', '_airbyte_raw_gl_periods') }}
select
    {{ json_extract_scalar('_airbyte_data', ['END_DATE'], ['END_DATE']) }} as end_date,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE1'], ['ATTRIBUTE1']) }} as attribute1,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE2'], ['ATTRIBUTE2']) }} as attribute2,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE3'], ['ATTRIBUTE3']) }} as attribute3,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE4'], ['ATTRIBUTE4']) }} as attribute4,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE5'], ['ATTRIBUTE5']) }} as attribute5,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE6'], ['ATTRIBUTE6']) }} as attribute6,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE7'], ['ATTRIBUTE7']) }} as attribute7,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE8'], ['ATTRIBUTE8']) }} as attribute8,
    {{ json_extract_scalar('_airbyte_data', ['CREATED_BY'], ['CREATED_BY']) }} as created_by,
    {{ json_extract_scalar('_airbyte_data', ['PERIOD_NUM'], ['PERIOD_NUM']) }} as period_num,
    {{ json_extract_scalar('_airbyte_data', ['START_DATE'], ['START_DATE']) }} as start_date,
    {{ json_extract_scalar('_airbyte_data', ['DESCRIPTION'], ['DESCRIPTION']) }} as description,
    {{ json_extract_scalar('_airbyte_data', ['FISCAL_YEAR'], ['FISCAL_YEAR']) }} as fiscal_year,
    {{ json_extract_scalar('_airbyte_data', ['PERIOD_NAME'], ['PERIOD_NAME']) }} as period_name,
    {{ json_extract_scalar('_airbyte_data', ['PERIOD_TYPE'], ['PERIOD_TYPE']) }} as period_type,
    {{ json_extract_scalar('_airbyte_data', ['PERIOD_YEAR'], ['PERIOD_YEAR']) }} as period_year,
    {{ json_extract_scalar('_airbyte_data', ['QUARTER_NUM'], ['QUARTER_NUM']) }} as quarter_num,
    {{ json_extract_scalar('_airbyte_data', ['CREATION_DATE'], ['CREATION_DATE']) }} as creation_date,
    {{ json_extract_scalar('_airbyte_data', ['ENTERPRISE_ID'], ['ENTERPRISE_ID']) }} as enterprise_id,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE_DATE1'], ['ATTRIBUTE_DATE1']) }} as attribute_date1,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE_DATE2'], ['ATTRIBUTE_DATE2']) }} as attribute_date2,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE_DATE3'], ['ATTRIBUTE_DATE3']) }} as attribute_date3,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE_DATE4'], ['ATTRIBUTE_DATE4']) }} as attribute_date4,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE_DATE5'], ['ATTRIBUTE_DATE5']) }} as attribute_date5,
    {{ json_extract_scalar('_airbyte_data', ['LAST_UPDATED_BY'], ['LAST_UPDATED_BY']) }} as last_updated_by,
    {{ json_extract_scalar('_airbyte_data', ['PERIOD_SET_NAME'], ['PERIOD_SET_NAME']) }} as period_set_name,
    {{ json_extract_scalar('_airbyte_data', ['YEAR_START_DATE'], ['YEAR_START_DATE']) }} as year_start_date,
    {{ json_extract_scalar('_airbyte_data', ['LAST_UPDATE_DATE'], ['LAST_UPDATE_DATE']) }} as last_update_date,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE_NUMBER1'], ['ATTRIBUTE_NUMBER1']) }} as attribute_number1,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE_NUMBER2'], ['ATTRIBUTE_NUMBER2']) }} as attribute_number2,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE_NUMBER3'], ['ATTRIBUTE_NUMBER3']) }} as attribute_number3,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE_NUMBER4'], ['ATTRIBUTE_NUMBER4']) }} as attribute_number4,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE_NUMBER5'], ['ATTRIBUTE_NUMBER5']) }} as attribute_number5,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE1'], ['GLOBAL_ATTRIBUTE1']) }} as global_attribute1,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE2'], ['GLOBAL_ATTRIBUTE2']) }} as global_attribute2,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE3'], ['GLOBAL_ATTRIBUTE3']) }} as global_attribute3,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE4'], ['GLOBAL_ATTRIBUTE4']) }} as global_attribute4,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE5'], ['GLOBAL_ATTRIBUTE5']) }} as global_attribute5,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE6'], ['GLOBAL_ATTRIBUTE6']) }} as global_attribute6,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE7'], ['GLOBAL_ATTRIBUTE7']) }} as global_attribute7,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE8'], ['GLOBAL_ATTRIBUTE8']) }} as global_attribute8,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE9'], ['GLOBAL_ATTRIBUTE9']) }} as global_attribute9,
    {{ json_extract_scalar('_airbyte_data', ['LAST_UPDATE_LOGIN'], ['LAST_UPDATE_LOGIN']) }} as last_update_login,
    {{ json_extract_scalar('_airbyte_data', ['ATTRIBUTE_CATEGORY'], ['ATTRIBUTE_CATEGORY']) }} as attribute_category,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE10'], ['GLOBAL_ATTRIBUTE10']) }} as global_attribute10,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE11'], ['GLOBAL_ATTRIBUTE11']) }} as global_attribute11,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE12'], ['GLOBAL_ATTRIBUTE12']) }} as global_attribute12,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE13'], ['GLOBAL_ATTRIBUTE13']) }} as global_attribute13,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE14'], ['GLOBAL_ATTRIBUTE14']) }} as global_attribute14,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE15'], ['GLOBAL_ATTRIBUTE15']) }} as global_attribute15,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE16'], ['GLOBAL_ATTRIBUTE16']) }} as global_attribute16,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE17'], ['GLOBAL_ATTRIBUTE17']) }} as global_attribute17,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE18'], ['GLOBAL_ATTRIBUTE18']) }} as global_attribute18,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE19'], ['GLOBAL_ATTRIBUTE19']) }} as global_attribute19,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE20'], ['GLOBAL_ATTRIBUTE20']) }} as global_attribute20,
    {{ json_extract_scalar('_airbyte_data', ['QUARTER_START_DATE'], ['QUARTER_START_DATE']) }} as quarter_start_date,
    {{ json_extract_scalar('_airbyte_data', ['CONFIRMATION_STATUS'], ['CONFIRMATION_STATUS']) }} as confirmation_status,
    {{ json_extract_scalar('_airbyte_data', ['ENTERED_PERIOD_NAME'], ['ENTERED_PERIOD_NAME']) }} as entered_period_name,
    {{ json_extract_scalar('_airbyte_data', ['OBJECT_VERSION_NUMBER'], ['OBJECT_VERSION_NUMBER']) }} as object_version_number,
    {{ json_extract_scalar('_airbyte_data', ['ADJUSTMENT_PERIOD_FLAG'], ['ADJUSTMENT_PERIOD_FLAG']) }} as adjustment_period_flag,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE_DATE1'], ['GLOBAL_ATTRIBUTE_DATE1']) }} as global_attribute_date1,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE_DATE2'], ['GLOBAL_ATTRIBUTE_DATE2']) }} as global_attribute_date2,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE_DATE3'], ['GLOBAL_ATTRIBUTE_DATE3']) }} as global_attribute_date3,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE_DATE4'], ['GLOBAL_ATTRIBUTE_DATE4']) }} as global_attribute_date4,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE_DATE5'], ['GLOBAL_ATTRIBUTE_DATE5']) }} as global_attribute_date5,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE_NUMBER1'], ['GLOBAL_ATTRIBUTE_NUMBER1']) }} as global_attribute_number1,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE_NUMBER2'], ['GLOBAL_ATTRIBUTE_NUMBER2']) }} as global_attribute_number2,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE_NUMBER3'], ['GLOBAL_ATTRIBUTE_NUMBER3']) }} as global_attribute_number3,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE_NUMBER4'], ['GLOBAL_ATTRIBUTE_NUMBER4']) }} as global_attribute_number4,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE_NUMBER5'], ['GLOBAL_ATTRIBUTE_NUMBER5']) }} as global_attribute_number5,
    {{ json_extract_scalar('_airbyte_data', ['GLOBAL_ATTRIBUTE_CATEGORY'], ['GLOBAL_ATTRIBUTE_CATEGORY']) }} as global_attribute_category,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    {{ current_timestamp() }} as _airbyte_normalized_at
from {{ source('pxhgpeza', '_airbyte_raw_gl_periods') }} as table_alias
-- gl_periods
where 1 = 1
{{ incremental_clause('_airbyte_emitted_at') }}

